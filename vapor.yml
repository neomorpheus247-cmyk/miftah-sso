id: 12345
name: miftah-sso
environments:
    production:
        memory: 1024
        cli-memory: 512
        runtime: 'php-8.2'
        build:
            - 'composer install --no-dev'
            - 'php artisan event:cache'
            - 'npm ci'
            - 'npm run build'
            - 'rm -rf node_modules'
        deploy:
            - 'php artisan migrate --force'
            - 'php artisan config:cache'
            - 'php artisan route:cache'
            - 'php artisan view:cache'
            - 'php artisan storage:link'
        database: vapor
        cache: vapor
        queue: vapor
        domain: api.yourdomain.com
        firewall:
            rate-limit: 60
        queues:
            - delayed-logout
        warm: 5
        timeout: 30
        environment:
            APP_NAME: "MiftahSSO"
            GOOGLE_CLIENT_ID: "${GOOGLE_CLIENT_ID}"
            GOOGLE_CLIENT_SECRET: "${GOOGLE_CLIENT_SECRET}"
            SANCTUM_STATEFUL_DOMAINS: "yourdomain.com"
            SESSION_DOMAIN: ".yourdomain.com"
            SESSION_DRIVER: "cookie"
            SESSION_SECURE_COOKIE: "true"

    staging:
        memory: 1024
        cli-memory: 512
        runtime: 'php-8.2'
        build:
            - 'composer install'
            - 'php artisan event:cache'
            - 'npm ci && npm run build'
        deploy:
            - 'php artisan migrate --force'
        database: vapor
        cache: vapor
        queue: vapor
        domain: staging.api.yourdomain.com
        warm: 1
        environment:
            APP_DEBUG: "true"